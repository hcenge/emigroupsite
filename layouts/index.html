{{ define "title" }}{{ .Title }}{{ end }}
{{ define "main" }}
<section class="bbc-home">
  {{ with .Params.banner }}
  <div class="bbc-hero-banner-parallax" id="hero-banner">
    <div class="bbc-hero-banner-parallax__bg" style="background-image: url('{{ .image }}');"></div>
    <div class="bbc-hero-banner-parallax__overlay">
      {{ if .logo }}
      <div class="bbc-hero-banner-parallax__logo">
        <p class="bbc-hero-banner-parallax__group-name">Weatherup Group</p>
        <img src="{{ .logo }}" alt="EMI Group Logo">
      </div>
      {{ end }}
      <p class="bbc-hero-banner-parallax__tagline">{{ .tagline }}</p>
    </div>
  </div>
  {{ end }}

  <div class="bbc-home__content">
    <div class="bbc-home__main">
      {{ if .Params.lede }}
      <p class="bbc-lede">{{ .Params.lede }}</p>
      {{ end }}

      {{ if .Params.pillars }}
      <div class="bbc-pillars">
        {{ range .Params.pillars }}
        <div class="bbc-pillar">
          <div class="bbc-pillar__icon">{{ .icon }}</div>
          <h3 class="bbc-pillar__title">{{ .title }}</h3>
          <p class="bbc-pillar__description">{{ .description }}</p>
        </div>
        {{ end }}
      </div>
      {{ end }}

      {{ .Content }}

      {{ with .Params.cta }}
      <div class="bbc-research-cta">
        <div class="bbc-research-cta__content">
          <h2 class="bbc-research-cta__title">{{ .title }}</h2>
          <p class="bbc-research-cta__text">{{ .text }}</p>
        </div>
        <a href="{{ .button_link }}" class="bbc-research-cta__button">{{ .button_text }}</a>
      </div>
      {{ end }}

      {{ $newsPages := (where .Site.RegularPages "Section" "news").ByDate.Reverse }}
      {{ if gt (len $newsPages) 0 }}
      <div class="bbc-news-carousel">
        <div class="bbc-news-carousel__header">
          <h2 class="bbc-news-carousel__title">Latest News</h2>
          <a href="/news/" class="bbc-news-carousel__view-all">View All News →</a>
        </div>
        <div class="bbc-news-carousel__container">
          <div class="bbc-news-carousel__track">
            {{ range first 5 $newsPages }}
            <div class="bbc-news-carousel__item">
              <article class="bbc-card bbc-card--carousel">
                <a class="bbc-card__link" href="{{ .RelPermalink }}">
                  {{ with .Params.image }}
                  <figure class="bbc-card__media">
                    <img src="{{ . }}" alt="{{ $.Title }} illustration">
                  </figure>
                  {{ end }}
                  <div class="bbc-card__body bbc-stack bbc-stack--gap-sm">
                    <h3 class="bbc-card__title">{{ .Title }}</h3>
                    {{ with .Params.summary }}<p class="bbc-card__summary">{{ . }}</p>{{ end }}
                    <span class="bbc-card__meta bbc-flex-row bbc-flex-row--wrap bbc-flex-row--gap-sm">
                      <time class="bbc-card__date" datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2 January 2006" }}</time>
                    </span>
                  </div>
                </a>
              </article>
            </div>
            {{ end }}
          </div>
        </div>
        <div class="bbc-news-carousel__controls">
          <button class="bbc-carousel-button bbc-news-carousel__button bbc-news-carousel__button--prev" aria-label="Previous">‹</button>
          <button class="bbc-carousel-button bbc-news-carousel__button bbc-news-carousel__button--next" aria-label="Next">›</button>
        </div>
        <div class="bbc-news-carousel__dots"></div>
      </div>
      {{ end }}


    </div>
  </div>
</section>
{{ end }}
