{{ define "title" }}{{ .Title }}{{ end }}
{{ define "main" }}
<section class="bbc-home">
  {{ with .Params.banner }}
  <div class="bbc-hero-banner-parallax" id="hero-banner">
    <div class="bbc-hero-banner-parallax__bg" style="background-image: url('{{ .image }}');"></div>
    <div class="bbc-hero-banner-parallax__overlay">
      {{ if .logo }}
      <div class="bbc-hero-banner-parallax__logo">
        <p class="bbc-hero-banner-parallax__group-name">Weatherup Group</p>
        <img src="{{ .logo }}" alt="EMI Group Logo">
      </div>
      {{ end }}
      <p class="bbc-hero-banner-parallax__tagline">{{ .tagline }}</p>
    </div>
  </div>
  {{ end }}

  <div class="bbc-home__content">
    <div class="bbc-home__main">
      {{ if .Params.lede }}
      <p class="bbc-lede">{{ .Params.lede }}</p>
      {{ end }}

      {{ if .Params.pillars }}
      <div class="bbc-pillars">
        {{ range .Params.pillars }}
        <div class="bbc-pillar">
          <div class="bbc-pillar__icon">{{ .icon }}</div>
          <h3 class="bbc-pillar__title">{{ .title }}</h3>
          <p class="bbc-pillar__description">{{ .description }}</p>
        </div>
        {{ end }}
      </div>
      {{ end }}

      {{ .Content }}

      {{ with .Params.cta }}
      <div class="bbc-research-cta">
        <div class="bbc-research-cta__content">
          <h2 class="bbc-research-cta__title">{{ .title }}</h2>
          <p class="bbc-research-cta__text">{{ .text }}</p>
        </div>
        <a href="{{ .button_link }}" class="bbc-research-cta__button">{{ .button_text }}</a>
      </div>
      {{ end }}

      {{ $newsPages := (where .Site.RegularPages "Section" "news").ByDate.Reverse }}
      {{ if gt (len $newsPages) 0 }}
      <div class="bbc-news-carousel">
        <div class="bbc-news-carousel__header">
          <h2 class="bbc-news-carousel__title">Latest News</h2>
          <a href="/news/" class="bbc-news-carousel__view-all">View All News →</a>
        </div>
        <div class="bbc-news-carousel__container">
          <div class="bbc-news-carousel__track">
            {{ range first 5 $newsPages }}
            <div class="bbc-news-carousel__item">
              <a href="{{ .RelPermalink }}" class="bbc-news-carousel__link">
                {{ with .Params.image }}
                <div class="bbc-news-carousel__image" style="background-image: url('{{ . }}');"></div>
                {{ end }}
                <div class="bbc-news-carousel__content">
                  <time class="bbc-news-carousel__date">{{ .Date.Format "2 January 2006" }}</time>
                  <h3 class="bbc-news-carousel__item-title">{{ .Title }}</h3>
                  {{ with .Params.summary }}
                  <p class="bbc-news-carousel__summary">{{ . }}</p>
                  {{ end }}
                </div>
              </a>
            </div>
            {{ end }}
          </div>
        </div>
        <div class="bbc-news-carousel__controls">
          <button class="bbc-news-carousel__button bbc-news-carousel__button--prev" aria-label="Previous">‹</button>
          <button class="bbc-news-carousel__button bbc-news-carousel__button--next" aria-label="Next">›</button>
        </div>
        <div class="bbc-news-carousel__dots"></div>
      </div>
      {{ end }}


    </div>
  </div>
</section>
{{ end }}
