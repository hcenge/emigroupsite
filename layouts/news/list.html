{{ define "title" }}{{ .Title }}{{ end }}
{{ define "main" }}
<section class="bbc-research">
  <h1 class="bbc-heading">{{ .Title }}</h1>
  {{ with .Content }}
  <div class="bbc-generic-content">
    {{ . }}
  </div>
  {{ end }}

  {{ $allPages := .Pages.ByDate.Reverse }}

  <div class="bbc-grid bbc-grid--split bbc-grid--featured">
    {{ with index $allPages 0 }}
    <article class="bbc-card bbc-card--hero">
      <a class="bbc-card__link" href="{{ .RelPermalink }}">
        {{ with .Params.image }}
        <figure class="bbc-card__media">
          <img src="{{ . }}" alt="{{ $.Title }} hero image">
        </figure>
        {{ end }}
        <div class="bbc-card__body">
          <h2 class="bbc-card__title">{{ .Title }}</h2>
          {{ with .Params.summary }}<p class="bbc-card__summary">{{ . }}</p>{{ end }}
          <span class="bbc-card__meta">
            {{ with .Date }}<time class="bbc-card__date" datetime="{{ .Format "2006-01-02" }}">{{ .Format "2 January 2006" }}</time>{{ end }}
          </span>
        </div>
      </a>
    </article>
    {{ end }}

    <div class="bbc-grid__column bbc-grid__column--aside">
      {{ range first 2 (after 1 $allPages) }}
      <article class="bbc-card bbc-card--aside">
        <a class="bbc-card__link" href="{{ .RelPermalink }}">
          {{ with .Params.image }}
          <figure class="bbc-card__media">
            <img src="{{ . }}" alt="{{ $.Title }} illustration">
          </figure>
          {{ end }}
          <div class="bbc-card__body">
            <h3 class="bbc-card__title">{{ .Title }}</h3>
            {{ with .Params.summary }}<p class="bbc-card__summary">{{ . }}</p>{{ end }}
            <span class="bbc-card__meta">
              {{ with .Date }}<time class="bbc-card__date" datetime="{{ .Format "2006-01-02" }}">{{ .Format "2 January 2006" }}</time>{{ end }}
            </span>
          </div>
        </a>
      </article>
      {{ end }}
    </div>

    <div class="bbc-grid__column bbc-grid__column--stack">
      {{ range after 3 $allPages }}
      <article class="bbc-card bbc-card--compact">
        <a class="bbc-card__link" href="{{ .RelPermalink }}">
          {{ with .Params.image }}
          <figure class="bbc-card__media">
            <img src="{{ . }}" alt="{{ $.Title }} illustration">
          </figure>
          {{ end }}
          <div class="bbc-card__body">
            <h4 class="bbc-card__title">{{ .Title }}</h4>
            {{ with .Params.summary }}<p class="bbc-card__summary">{{ . }}</p>{{ end }}
            <span class="bbc-card__meta">
              {{ with .Date }}<time class="bbc-card__date" datetime="{{ .Format "2006-01-02" }}">{{ .Format "2 January 2006" }}</time>{{ end }}
            </span>
          </div>
        </a>
      </article>
      {{ end }}
    </div>
  </div>
</section>
{{ end }}
